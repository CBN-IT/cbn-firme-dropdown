<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../../bower_components/cbn-btn-styles/cbn-btn-styles.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../bower_components/iron-icons/iron-icons.html">

<dom-module id="cbn-firme-dropdown">
    <template>
        <style include="cbn-btn-styles">
            :host {
                display: block;
            }
            :host([hidden]) {
                display: none;
            }
            .firm-option{
                min-height: 30px;
                border-top: 1px solid #cecece;
                color: black;
                padding: 0 15px;
                font-size: 16px;
                display: flex;
                align-items: center;
            }

            .firm-option:hover{
                cursor: pointer;
                color: white;
                background-color: var(--selected-menu-color);
            }
            .btn-trigger{
                border-bottom: 1px solid white;
            }

            paper-menu-button{
                padding: 0 8px;
                --paper-menu-button-dropdown:{
                    min-width: 190px;
                    margin-top: var(--dropdown-margin-top)
                };
            }
            .firm-name{
                min-width: 150px;
                text-align: left;
            }
        </style>
        <paper-menu-button id="dropdownFirme" no-animations no-overlap>
            <button slot="dropdown-trigger" class="btn ripple btn-trigger">
                <div class="firm-name">{{cont._numeFirma}}</div>
                <iron-icon icon="arrow-drop-down"></iron-icon>
            </button>
            <div slot="dropdown-content">
                <template is="dom-repeat" items="{{conturi}}">
                    <div name="{{item._keyFirma}}" on-click="changedNamespace" class="firm-option">{{item._numeFirma}}</div>
                </template>
            </div>
        </paper-menu-button>
    </template>

    <script>
        /**
         * `cbn-firme-dropdown`
         *
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class CbnFirmeDropdown extends Polymer.Element {
            static get is() {
                return 'cbn-firme-dropdown';
            }

            static get properties() {
                return {
                    conturi: {
                        type: Array
                    },
                    namespace: {
                        type: String
                    },
                    cont: {
                        type: Object
                    }
                };
            }
            changedNamespace(event){
                event.preventDefault();
                event.stopPropagation();

                if(event.model.item["_keyFirma"] != this.namespace){
                    window.open(window.location.origin + "?namespace=" + event.model.item["_keyFirma"]);
                    console.log("fereastra noua");
                }
                this.$.dropdownFirme.opened = false;
            }
        }

        window.customElements.define(CbnFirmeDropdown.is, CbnFirmeDropdown);
    </script>
</dom-module>
